// Decorator Design Pattern
import java.util.*;
interface INotification{
    String getContent();
}
class SimpleNotification implements  INotification{
    private String data;
    public SimpleNotification(String data) {
        this.data=data;
    }

    @Override
    public String getContent() {
        return data;
    }
}

abstract class INotificationDecorator implements  INotification{

}
class TimeStampDecorator extends INotificationDecorator {
    private INotification n;
    TimeStampDecorator(INotification n){
        this.n=n;
    }

    @Override
    public String getContent() {
        return n.getContent() + "####05##11##2025###";
    }
}

class Signature extends INotificationDecorator {
    private INotification n;
    Signature(INotification n){
        this.n=n;
    }

    @Override
    public String getContent() {
        return n.getContent() + "SN";
    }
}
// Observer Design Pattern
abstract class IObserver{
    abstract void update();
}
abstract class IObserveble{

    abstract void addObserver(IObserver o);
    abstract void removeObserver(IObserver o);
    abstract void getNotify();
}
class NotificationObserveble extends  IObserveble{
    private List<IObserver> observers=new ArrayList<>();
    private INotification notification;

    @Override
    void addObserver(IObserver o) {
        observers.add(o);
    }

    @Override
    void removeObserver(IObserver o) {
        observers.remove(o);
    }

    @Override
    void getNotify() {
        for(IObserver o:observers){
            o.update();
        }
    }
    public INotification getNotification(){
        return notification;
    }
    public void setNotification(INotification notification){
        this.notification=notification;
        getNotify();
    }
    public String getNotificationContent(){
        return notification.getContent();
    }
}
class Logger extends IObserver{
    NotificationObserveble n;
    Logger(NotificationObserveble n){
        this.n=n;
    }
    @Override
    void update() {
        System.out.println("Logging new Notification : "+ n.getNotificationContent());
    }
}

abstract class INotificationStategy{
    abstract void sendNotification(String content);
}
class EmailNotificationStrategy extends  INotificationStategy{
    String email;
    EmailNotificationStrategy(String email){
        this.email=email;
    }

    @Override
    void sendNotification(String content) {
        System.out.println("Sending emial notification to "+ email + " " + content);
    }
}
class NotificationEngine extends IObserver{
    NotificationObserveble n;
    INotificationStategy ns;
    NotificationEngine(NotificationObserveble n,INotificationStategy ns){
        this.n=n;
        this.ns=ns;
    }

    @Override
    void update() {
        String data=n.getNotificationContent();
        ns.sendNotification(data);
    }
}
class NotificationServer{
    private NotificationObserveble observeble;
    private static NotificationServer instance;
    private List<INotification> notifications=new ArrayList<>();
    private NotificationServer(){
        observeble=new NotificationObserveble();
    }
    public static NotificationServer getInstance(){
        if(instance==null){
            instance=new NotificationServer();
        }
        return instance;
    }
    public NotificationObserveble getObservable(){
        return observeble;
    }
    public void sendNotification(INotification notification){
        notifications.add(notification);
        observeble.setNotification(notification);
    }

}

public class Main {
    public static void main(String[] args) {
        NotificationServer notificationServer=NotificationServer.getInstance();
        NotificationObserveble notificationObserveble=notificationServer.getObservable();
        Logger logger=new Logger(notificationObserveble);
        NotificationEngine notificationEngine=new NotificationEngine(notificationObserveble,new EmailNotificationStrategy("Soumeshnayak@gmail.com"));

        notificationObserveble.addObserver(logger);
        notificationObserveble.addObserver(notificationEngine);

        INotification notification=new SimpleNotification("Your Order has been shipped!");
        notification=new TimeStampDecorator(notification);
        
        notificationServer.sendNotification(notification);
    }
}
